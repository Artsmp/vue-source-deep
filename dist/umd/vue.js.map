{"version":3,"file":"vue.js","sources":["../../src/util/index.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["/**\n * 判断 data 是不是一个对象\n * @param {*} data\n * @returns\n */\nexport function isObj(data) {\n  return typeof data === 'object' && data !== null\n}\n","import { isObj } from '../util/index'\n\nclass Observer {\n  constructor(value) {\n    // 需要递归遍历深层次对象\n    this.walk(value)\n  }\n\n  walk(data) {\n    let keys = Object.keys(data) // [name, age, address]\n    for (let i = 0; i < keys.length; i++) {\n      let key = keys[i]\n      let value = data[key]\n      defineReactive(data, key, value)\n    }\n  }\n}\n\n// 把 data 数据都使用 Object.defineProperty 重新定义（不能兼容 IE8 及以下）\nexport function observe(data) {\n  if (!isObj(data)) {\n    return\n  }\n  return new Observer(data)\n}\n\nfunction defineReactive(data, key, value) {\n  observe(value) // 递归实现深度劫持\n  Object.defineProperty(data, key, {\n    get() {\n      // 获取值得时候做操作\n      return value\n    },\n    set(newVal) {\n      // 设置值的时候做操作\n      if (value === newVal) return\n      console.log('==>值发生变化了')\n      observe(newVal) // 避免用户是赋值为一个新对象而没有深度劫持\n      value = newVal\n    },\n  })\n}\n","import { observe } from \"./observer/index\"\n\nexport function initState(vm) {\n  // vue 的数据来源：props、data、computed、method、watch\n  const opt = vm.$options\n  if (opt.props) {\n    initProps(vm)\n  }\n  if (opt.methods) {\n    initMethods(vm)\n  }\n  if (opt.data) {\n    initData(vm)\n  }\n  if (opt.computed) {\n    initComputed(vm)\n  }\n  if (opt.watch) {\n    initWatch(vm)\n  }\n}\n\nfunction initProps(vm) {}\nfunction initMethods(vm) {}\nfunction initData(vm) {\n  // 数据初始化工作\n  let data = vm.$options.data\n  // 数据也要挂载一份到实例上\n  data = vm._data = typeof data === 'function' ? data.call(this) : data\n  // 对象劫持，用户改变了数据我希望能够得到通知 => 刷新页面：数据变化视图变化 MVVM Object.defineProperty\n  observe(data) // 响应式原理\n}\nfunction initComputed(vm) {}\nfunction initWatch(vm) {}\n","import { initState } from './state'\n\nexport function initMixin(Vue) {\n  // 初始化流程\n  Vue.prototype._init = function (options) {\n    // 1. 数据的劫持\n    const vm = this\n    vm.$options = options // this.$options 指代的就是用户传递的属性\n\n    // 初始化状态(vue的数据来源)\n    initState(vm)\n  }\n}\n","// vue 入口文件，只是一个 Vue 的声明，主要功能是整合\nimport { initMixin } from './init'\n\nfunction Vue(options) {\n  // 进行 Vue 的初始化操作\n  this._init(options)\n}\n// 把流程拆成一个个原型上的方法，通过引入文件的方式给Vue添加原型上的方法\ninitMixin(Vue)\n// initRender(Vue)\n\nexport default Vue\n"],"names":["isObj","data","Observer","constructor","value","walk","keys","Object","i","length","key","defineReactive","observe","defineProperty","get","set","newVal","console","log","initState","vm","opt","$options","props","methods","initData","computed","watch","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":"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"}